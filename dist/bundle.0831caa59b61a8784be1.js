/*! For license information please see bundle.0831caa59b61a8784be1.js.LICENSE.txt */
(()=>{"use strict";var e,n={923:(e,n,t)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function r(){var e,n,t="function"==typeof Symbol?Symbol:{},o=t.iterator||"@@iterator",i=t.toStringTag||"@@toStringTag";function c(t,o,r,i){var c=o&&o.prototype instanceof l?o:l,d=Object.create(c.prototype);return a(d,"_invoke",function(t,o,r){var a,i,c,l=0,d=r||[],u=!1,p={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(n,t){return a=n,i=0,c=e,p.n=t,s}};function f(t,o){for(i=t,c=o,n=0;!u&&l&&!r&&n<d.length;n++){var r,a=d[n],f=p.p,m=a[2];t>3?(r=m===o)&&(c=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=f&&((r=t<2&&f<a[1])?(i=0,p.v=o,p.n=a[1]):f<m&&(r=t<3||a[0]>o||o>m)&&(a[4]=t,a[5]=o,p.n=m,i=0))}if(r||t>1)return s;throw u=!0,o}return function(r,d,m){if(l>1)throw TypeError("Generator is already running");for(u&&1===d&&f(d,m),i=d,c=m;(n=i<2?e:c)||!u;){a||(i?i<3?(i>1&&(p.n=-1),f(i,c)):p.n=c:p.v=c);try{if(l=2,a){if(i||(r="next"),n=a[r]){if(!(n=n.call(a,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,i<2&&(i=0)}else 1===i&&(n=a.return)&&n.call(a),i<2&&(c=TypeError("The iterator does not provide a '"+r+"' method"),i=1);a=e}else if((n=(u=p.n<0)?c:t.call(o,p))!==s)break}catch(n){a=e,i=1,c=n}finally{l=1}}return{value:n,done:u}}}(t,r,i),!0),d}var s={};function l(){}function d(){}function u(){}n=Object.getPrototypeOf;var p=[][o]?n(n([][o]())):(a(n={},o,function(){return this}),n),f=u.prototype=l.prototype=Object.create(p);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,a(e,i,"GeneratorFunction")),e.prototype=Object.create(f),e}return d.prototype=u,a(f,"constructor",u),a(u,"constructor",d),d.displayName="GeneratorFunction",a(u,i,"GeneratorFunction"),a(f),a(f,i,"Generator"),a(f,o,function(){return this}),a(f,"toString",function(){return"[object Generator]"}),(r=function(){return{w:c,m}})()}function a(e,n,t,o){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}a=function(e,n,t,o){function i(n,t){a(e,n,function(e){return this._invoke(n,t,e)})}n?r?r(e,n,{value:t,enumerable:!o,configurable:!o,writable:!o}):e[n]=t:(i("next",0),i("throw",1),i("return",2))},a(e,n,t,o)}function i(e,n,t,o,r,a,i){try{var c=e[a](i),s=c.value}catch(e){return void t(e)}c.done?n(s):Promise.resolve(s).then(o,r)}function c(e){return function(){var n=this,t=arguments;return new Promise(function(o,r){var a=e.apply(n,t);function c(e){i(a,o,r,c,s,"next",e)}function s(e){i(a,o,r,c,s,"throw",e)}c(void 0)})}}function s(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,l(o.key),o)}}function l(e){var n=function(e){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,"string");if("object"!=o(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==o(n)?n:n+""}var d=function(){return e=function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.installPrompt=null,this.isOnline=navigator.onLine,this.init()},n=[{key:"init",value:(a=c(r().m(function e(){return r().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.registerServiceWorker();case 1:this.setupInstallPrompt(),this.setupOnlineOfflineHandlers(),this.setupPerformanceMonitoring();case 2:return e.a(2)}},e,this)})),function(){return a.apply(this,arguments)})},{key:"registerServiceWorker",value:(o=c(r().m(function e(){var n,t,o=this;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!("serviceWorker"in navigator)){e.n=4;break}return e.p=1,e.n=2,navigator.serviceWorker.register("/sw.js");case 2:n=e.v,console.log("Service Worker registered successfully:",n),n.addEventListener("updatefound",function(){var e=n.installing;e&&e.addEventListener("statechange",function(){"installed"===e.state&&navigator.serviceWorker.controller&&o.showUpdateAvailable()})}),navigator.serviceWorker.addEventListener("message",function(e){e.data&&"BACK_ONLINE"===e.data.type&&o.handleBackOnline()}),e.n=4;break;case 3:e.p=3,t=e.v,console.error("Service Worker registration failed:",t);case 4:return e.a(2)}},e,null,[[1,3]])})),function(){return o.apply(this,arguments)})},{key:"setupInstallPrompt",value:function(){var e=this;window.addEventListener("beforeinstallprompt",function(n){console.log("PWA: Install prompt available"),n.preventDefault(),e.installPrompt=n,e.showInstallButton()}),window.addEventListener("appinstalled",function(){console.log("PWA: App was installed"),e.hideInstallButton(),e.trackEvent("pwa_installed")})}},{key:"showInstallButton",value:function(){var e=this,n=document.createElement("button");n.id="pwa-install-btn",n.innerHTML='\n      <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">\n        <path d="M19,18H6V6H19M21,4H3A2,2 0 0,0 1,6V18A2,2 0 0,0 3,20H21A2,2 0 0,0 23,18V6A2,2 0 0,0 21,4Z"/>\n        <path d="M12,8L8,12H11V16H13V12H16L12,8Z"/>\n      </svg>\n      Install App\n    ',n.style.cssText="\n      position: fixed;\n      bottom: 20px;\n      right: 20px;\n      background: #2a4df5;\n      color: white;\n      border: none;\n      padding: 12px 16px;\n      border-radius: 8px;\n      cursor: pointer;\n      font-weight: 500;\n      display: flex;\n      align-items: center;\n      gap: 8px;\n      box-shadow: 0 4px 12px rgba(42, 77, 245, 0.3);\n      z-index: 1000;\n      transition: transform 0.2s ease;\n    ",n.addEventListener("mouseenter",function(){n.style.transform="scale(1.05)"}),n.addEventListener("mouseleave",function(){n.style.transform="scale(1)"}),n.addEventListener("click",function(){return e.installPWA()}),this.isPWAInstalled()||document.body.appendChild(n)}},{key:"hideInstallButton",value:function(){var e=document.getElementById("pwa-install-btn");e&&e.remove()}},{key:"installPWA",value:(t=c(r().m(function e(){var n,t;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:if(this.installPrompt){e.n=1;break}return e.a(2);case 1:return e.p=1,e.n=2,this.installPrompt.prompt();case 2:n=e.v,console.log("PWA: Install prompt result:",n.outcome),"accepted"===n.outcome?this.trackEvent("pwa_install_accepted"):this.trackEvent("pwa_install_dismissed"),this.installPrompt=null,this.hideInstallButton(),e.n=4;break;case 3:e.p=3,t=e.v,console.error("PWA: Install failed:",t);case 4:return e.a(2)}},e,this,[[1,3]])})),function(){return t.apply(this,arguments)})},{key:"isPWAInstalled",value:function(){return!(!window.matchMedia||!window.matchMedia("(display-mode: standalone)").matches)||!0===window.navigator.standalone}},{key:"setupOnlineOfflineHandlers",value:function(){var e=this;window.addEventListener("online",function(){console.log("PWA: Back online"),e.isOnline=!0,e.showOnlineStatus(),e.handleBackOnline()}),window.addEventListener("offline",function(){console.log("PWA: Gone offline"),e.isOnline=!1,e.showOfflineStatus()}),this.isOnline||this.showOfflineStatus()}},{key:"showOnlineStatus",value:function(){var e=document.getElementById("connection-status");e&&(e.style.cssText="\n        position: fixed;\n        top: 0;\n        left: 0;\n        right: 0;\n        background: #10b981;\n        color: white;\n        text-align: center;\n        padding: 8px;\n        font-size: 14px;\n        z-index: 1001;\n        transform: translateY(-100%);\n        transition: transform 0.3s ease;\n      ",e.textContent="‚úì Back online",e.style.transform="translateY(0)",setTimeout(function(){e&&(e.style.transform="translateY(-100%)",setTimeout(function(){return e.remove()},300))},3e3))}},{key:"showOfflineStatus",value:function(){var e=document.getElementById("connection-status");e||((e=document.createElement("div")).id="connection-status",document.body.appendChild(e)),e.style.cssText="\n      position: fixed;\n      top: 0;\n      left: 0;\n      right: 0;\n      background: #dc2626;\n      color: white;\n      text-align: center;\n      padding: 8px;\n      font-size: 14px;\n      z-index: 1001;\n    ",e.textContent="‚ö†Ô∏è You are offline. Some features may not work."}},{key:"handleBackOnline",value:function(){window.loadUserWaveforms&&"function"==typeof window.loadUserWaveforms&&window.loadUserWaveforms(),this.showOnlineStatus()}},{key:"showUpdateAvailable",value:function(){var e=document.createElement("div");e.style.cssText="\n      position: fixed;\n      bottom: 0;\n      left: 0;\n      right: 0;\n      background: #2a4df5;\n      color: white;\n      padding: 16px;\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      z-index: 1001;\n    ",e.innerHTML='\n      <span>üöÄ A new version is available!</span>\n      <div>\n        <button id="update-dismiss" style="background: transparent; color: white; border: 1px solid white; padding: 8px 12px; border-radius: 4px; margin-right: 8px; cursor: pointer;">\n          Later\n        </button>\n        <button id="update-reload" style="background: white; color: #2a4df5; border: none; padding: 8px 16px; border-radius: 4px; font-weight: 500; cursor: pointer;">\n          Update Now\n        </button>\n      </div>\n    ',document.body.appendChild(e),document.getElementById("update-dismiss").addEventListener("click",function(){e.remove()}),document.getElementById("update-reload").addEventListener("click",function(){window.location.reload()})}},{key:"setupPerformanceMonitoring",value:function(){var e=this;window.addEventListener("load",function(){if("performance"in window){var n=performance.getEntriesByType("navigation")[0];if(n){var t=n.loadEventEnd-n.loadEventStart;console.log("PWA: Page load time: ".concat(t,"ms")),e.trackPerformance("page_load_time",t)}}});var n=new PerformanceObserver(function(e){e.getEntries().forEach(function(e){e.duration>1e3&&console.warn("PWA: Slow resource: ".concat(e.name," (").concat(e.duration,"ms)"))})});try{n.observe({entryTypes:["resource"]})}catch(e){console.log("PWA: Performance Observer not supported")}}},{key:"trackEvent",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};console.log("PWA Event: ".concat(e),n),"undefined"!=typeof gtag&&gtag("event",e,n)}},{key:"trackPerformance",value:function(e,n){console.log("PWA Performance: ".concat(e," = ").concat(n)),"undefined"!=typeof gtag&&gtag("event","performance",{metric_name:e,metric_value:n})}}],n&&s(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n,t,o,a}();"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){new d}):new d;var u=t(517),p=t(223),f=t(532),m={apiKey:"AIzaSyAUTI2-Ab0-ZKaV0kon_60Uoa6SqJuldjk",authDomain:"leadlink-ai-api08.firebaseapp.com",projectId:"leadlink-ai-api08",storageBucket:"leadlink-ai-api08.firebasestorage.app",messagingSenderId:"365232756820",appId:"1:365232756820:web:55fcb722110cd5480d35c1"},g=["apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId"].filter(function(e){return!m[e]});g.length>0&&(console.error("üî• Missing Firebase configuration keys:",g),console.log("üìã Please create a .env file with your Firebase credentials, or update src/firebase-config.js directly"),console.log("üìù See .env.example for required environment variables"),"undefined"!=typeof window&&setTimeout(function(){var e=document.createElement("div");e.style.cssText="\n        position: fixed;\n        top: 0;\n        left: 0;\n        right: 0;\n        background: #dc2626;\n        color: white;\n        padding: 16px;\n        text-align: center;\n        z-index: 10000;\n        font-family: system-ui, sans-serif;\n      ",e.innerHTML="\n        üî• <strong>Firebase Configuration Missing</strong><br>\n        Please create a .env file with your Firebase credentials or contact the developer.\n      ",document.body.appendChild(e)},1e3),console.warn("‚ö†Ô∏è Using demo Firebase configuration. App functionality will be limited."),Object.assign(m,{apiKey:"demo-api-key",authDomain:"demo-project.firebaseapp.com",projectId:"demo-project",storageBucket:"demo-project.firebasestorage.app",messagingSenderId:"123456789",appId:"1:123456789:web:demo-app-id"}));var v=(0,p.Wp)(m),h=(0,u.xI)(v),w=new u.HF,y=(new u.IX,(0,f.c7)(v));function b(){var e,n,t="function"==typeof Symbol?Symbol:{},o=t.iterator||"@@iterator",r=t.toStringTag||"@@toStringTag";function a(t,o,r,a){var s=o&&o.prototype instanceof c?o:c,l=Object.create(s.prototype);return x(l,"_invoke",function(t,o,r){var a,c,s,l=0,d=r||[],u=!1,p={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(n,t){return a=n,c=0,s=e,p.n=t,i}};function f(t,o){for(c=t,s=o,n=0;!u&&l&&!r&&n<d.length;n++){var r,a=d[n],f=p.p,m=a[2];t>3?(r=m===o)&&(s=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=e):a[0]<=f&&((r=t<2&&f<a[1])?(c=0,p.v=o,p.n=a[1]):f<m&&(r=t<3||a[0]>o||o>m)&&(a[4]=t,a[5]=o,p.n=m,c=0))}if(r||t>1)return i;throw u=!0,o}return function(r,d,m){if(l>1)throw TypeError("Generator is already running");for(u&&1===d&&f(d,m),c=d,s=m;(n=c<2?e:s)||!u;){a||(c?c<3?(c>1&&(p.n=-1),f(c,s)):p.n=s:p.v=s);try{if(l=2,a){if(c||(r="next"),n=a[r]){if(!(n=n.call(a,s)))throw TypeError("iterator result is not an object");if(!n.done)return n;s=n.value,c<2&&(c=0)}else 1===c&&(n=a.return)&&n.call(a),c<2&&(s=TypeError("The iterator does not provide a '"+r+"' method"),c=1);a=e}else if((n=(u=p.n<0)?s:t.call(o,p))!==i)break}catch(n){a=e,c=1,s=n}finally{l=1}}return{value:n,done:u}}}(t,r,a),!0),l}var i={};function c(){}function s(){}function l(){}n=Object.getPrototypeOf;var d=[][o]?n(n([][o]())):(x(n={},o,function(){return this}),n),u=l.prototype=c.prototype=Object.create(d);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,x(e,r,"GeneratorFunction")),e.prototype=Object.create(u),e}return s.prototype=l,x(u,"constructor",l),x(l,"constructor",s),s.displayName="GeneratorFunction",x(l,r,"GeneratorFunction"),x(u),x(u,r,"Generator"),x(u,o,function(){return this}),x(u,"toString",function(){return"[object Generator]"}),(b=function(){return{w:a,m:p}})()}function x(e,n,t,o){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}x=function(e,n,t,o){function a(n,t){x(e,n,function(e){return this._invoke(n,t,e)})}n?r?r(e,n,{value:t,enumerable:!o,configurable:!o,writable:!o}):e[n]=t:(a("next",0),a("throw",1),a("return",2))},x(e,n,t,o)}function k(e,n,t,o,r,a,i){try{var c=e[a](i),s=c.value}catch(e){return void t(e)}c.done?n(s):Promise.resolve(s).then(o,r)}function E(e){return function(){var n=this,t=arguments;return new Promise(function(o,r){var a=e.apply(n,t);function i(e){k(a,o,r,i,c,"next",e)}function c(e){k(a,o,r,i,c,"throw",e)}i(void 0)})}}var L=null;function M(){return C.apply(this,arguments)}function C(){return C=E(b().m(function e(){var n,t,o,r,a,i,c,s,l,d,u,p,f,m,g,v,h=arguments;return b().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=h.length>0&&void 0!==h[0]?h[0]:0,t=h.length>1&&void 0!==h[1]&&h[1],L){e.n=1;break}return(o=document.getElementById("waveformsList"))&&o.classList.add("hidden"),e.a(2);case 1:return e.p=1,e.n=2,fetch("get_waveforms.php?user_id=".concat(encodeURIComponent(L.uid),"&offset=").concat(n,"&limit=5"));case 2:if((r=e.v).ok){e.n=3;break}throw new Error("Failed to load waveforms");case 3:return e.n=4,r.json();case 4:if(a=e.v,console.log("üîç Raw waveforms data:",a),Array.isArray(a)?(i=a,c=!1,s=a.length):(i=a.waveforms||[],c=a.has_more||!1,s=a.total||0),console.log("üîç Processed waveforms:",i.length,"items, hasMore:",c,"total:",s),l=document.getElementById("waveformsList"),d=document.getElementById("waveformsContainer"),l&&d){e.n=5;break}return e.a(2);case 5:0===i.length&&0===n?d.innerHTML='<div class="muted" style="text-align: center; padding: 20px;">No MemoryWaves yet. Create your first one above!</div>':i.length>0&&(u=i.map(function(e){var n=e.title||e.original_name||"Untitled",t=new Date(e.created_at).toLocaleDateString(),o=new Date(e.created_at).toLocaleTimeString();return'\n          <div class="waveform-item" style="border: 1px solid #e6e9f2; border-radius: 8px; padding: 12px; margin-bottom: 8px; background: #fafbfc;">\n            <div style="display: flex; justify-content: space-between; align-items: center;">\n              <div>\n                <strong style="color: #0b0d12;">'.concat(n,'</strong>\n                <div class="muted" style="font-size: 12px; margin-top: 2px;">\n                  ').concat(e.original_name," ‚Ä¢ ").concat(t," ").concat(o,'\n                </div>\n              </div>\n              <div style="display: flex; gap: 8px; flex-wrap: wrap;">\n                <button onclick="showMemoryModal(\'').concat(e.image_url,"', '").concat(n.replace(/'/g,"\\'"),"', '").concat(e.qr_url,'\')" class="secondary" style="font-size: 12px; padding: 4px 8px; border: none; cursor: pointer;">View</button>\n                <a href="').concat(e.qr_url,'" target="_blank" class="secondary" style="font-size: 12px; padding: 4px 8px;">QR</a>\n                <button onclick="showOrderOptions(').concat(e.id,", '").concat(e.image_url,"', '").concat(n.replace(/'/g,"\\'"),'\', this)" style="background: #2a4df5; border: none; color: white; padding: 4px 8px; border-radius: 4px; cursor: pointer; font-size: 12px;">Order Print</button>\n                <button onclick="deleteMemory(').concat(e.id,", '").concat(n.replace(/'/g,"\\'"),'\', this)" class="btn-delete" style="background: #dc3545; border: none; color: white; padding: 4px 8px; border-radius: 4px; cursor: pointer; font-size: 12px;">Delete</button>\n              </div>\n            </div>\n          </div>\n        ')}).join(""),t?((p=d.querySelector("#loadMoreBtn"))&&p.remove(),d.insertAdjacentHTML("beforeend",u)):d.innerHTML=u,c&&((f=document.createElement("div")).id="loadMoreBtn",f.style.cssText="text-align: center; margin-top: 16px;",f.innerHTML='\n          <button onclick="loadMoreMemories()" style="background: #6b7280; border: none; color: white; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-weight: 500;">\n            Load More ('.concat(s-n-i.length," remaining)\n          </button>\n        "),d.appendChild(f))),l.classList.remove("hidden"),l.style.display="block",window.currentWaveformsOffset=n+i.length,e.n=7;break;case 6:e.p=6,v=e.v,console.error("Error loading waveforms:",v),m=document.getElementById("waveformsContainer"),g=document.getElementById("waveformsList"),m&&(m.innerHTML='<div class="muted" style="text-align: center; padding: 20px;">Error loading waveforms</div>'),g&&g.classList.remove("hidden");case 7:return e.a(2)}},e,null,[[1,6]])})),C.apply(this,arguments)}var I=function(){return{authModal:document.getElementById("authModal"),mainContent:document.getElementById("mainContent"),userInfo:document.getElementById("userInfo"),btnLogin:document.getElementById("btnLogin"),btnLogout:document.getElementById("btnLogout"),userName:document.getElementById("userName"),userAvatar:document.getElementById("userAvatar"),btnCreate:document.getElementById("btnCreate"),status:document.getElementById("status"),emailInput:document.getElementById("emailInput"),passwordInput:document.getElementById("passwordInput"),btnEmailLogin:document.getElementById("btnEmailLogin"),btnEmailRegister:document.getElementById("btnEmailRegister")}};function O(){return(O=E(b().m(function e(n){var t,o;return b().w(function(e){for(;;)switch(e.n){case 0:return(t=I()).authModal.classList.add("hidden"),t.authModal.style.display="none",t.authModal.style.visibility="hidden",t.mainContent.classList.remove("page-disabled"),t.mainContent.style.filter="none",t.mainContent.style.opacity="1",t.mainContent.style.pointerEvents="auto",t.userInfo.classList.remove("hidden"),t.userName.textContent=n.displayName||n.email,t.userAvatar.src=n.photoURL||'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="%23ccc"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>',(o=document.getElementById("ordersLink"))&&(o.href="orders.php?user_id=".concat(encodeURIComponent(n.uid))),T(n.uid),L=n,window.updateCreateButtonState&&window.updateCreateButtonState(),e.n=1,M();case 1:return e.a(2)}},e)}))).apply(this,arguments)}function P(){console.log("üî• Initializing Firebase Auth...");var e=I();if(!e.btnLogin)return console.error("‚ùå Login button not found! DOM might not be ready."),void setTimeout(function(){console.log("üîÑ Retrying auth initialization..."),P()},1e3);console.log("‚úÖ Auth elements found, setting up listeners..."),e.btnLogin.dataset.initialized="true",(0,u.hg)(h,function(e){console.log("üî• Auth state changed:",e?"Logged in":"Logged out"),e?function(e){O.apply(this,arguments)}(e):function(){var e=I();e.authModal.classList.remove("hidden"),e.authModal.style.display="",e.authModal.style.visibility="",e.mainContent.classList.add("page-disabled"),e.mainContent.style.filter="",e.mainContent.style.opacity="",e.mainContent.style.pointerEvents="",e.userInfo.classList.add("hidden"),e.btnCreate.disabled=!0,e.btnLogin.disabled=!1,e.btnLogin.innerHTML='\n    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">\n      <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>\n      <path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>\n      <path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>\n      <path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>\n    </svg>\n    Sign in with Google\n  ';var n=document.getElementById("waveformsList");n&&n.classList.add("hidden")}()}),e.btnLogin.addEventListener("click",E(b().m(function n(){var t;return b().w(function(n){for(;;)switch(n.p=n.n){case 0:return console.log("üî• Google login button clicked..."),n.p=1,e.btnLogin.disabled=!0,e.btnLogin.textContent="Signing in...",n.n=2,(0,u.df)(h,w);case 2:n.v,n.n=4;break;case 3:n.p=3,t=n.v,console.error("Login failed:",t),alert("Login failed: "+t.message),e.btnLogin.disabled=!1,e.btnLogin.innerHTML='\n        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">\n          <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>\n          <path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>\n          <path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>\n          <path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>\n        </svg>\n        Sign in with Google\n      ';case 4:return n.a(2)}},n,null,[[1,3]])}))),e.btnLogout.addEventListener("click",E(b().m(function e(){var n;return b().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,(0,u.CI)(h);case 1:e.n=3;break;case 2:e.p=2,n=e.v,console.error("Logout failed:",n);case 3:return e.a(2)}},e,null,[[0,2]])}))),e.btnEmailLogin.addEventListener("click",E(b().m(function n(){var t,o,r,a;return b().w(function(n){for(;;)switch(n.p=n.n){case 0:if(n.p=0,t=e.emailInput.value.trim(),o=e.passwordInput.value,t&&o){n.n=1;break}return alert("Please enter both email and password"),n.a(2);case 1:return e.btnEmailLogin.disabled=!0,e.btnEmailLogin.textContent="Signing in...",n.n=2,(0,u.x9)(h,t,o);case 2:n.n=4;break;case 3:n.p=3,a=n.v,console.error("Email login failed:",a),r="Login failed","auth/user-not-found"===a.code?r="No account found with this email":"auth/wrong-password"===a.code?r="Incorrect password":"auth/invalid-email"===a.code?r="Invalid email address":"auth/too-many-requests"===a.code&&(r="Too many failed attempts. Please try again later"),alert(r),e.btnEmailLogin.disabled=!1,e.btnEmailLogin.textContent="Sign In";case 4:return n.a(2)}},n,null,[[0,3]])}))),e.btnEmailRegister.addEventListener("click",E(b().m(function n(){var t,o,r,a;return b().w(function(n){for(;;)switch(n.p=n.n){case 0:if(n.p=0,t=e.emailInput.value.trim(),o=e.passwordInput.value,t&&o){n.n=1;break}return alert("Please enter both email and password"),n.a(2);case 1:if(!(o.length<6)){n.n=2;break}return alert("Password must be at least 6 characters long"),n.a(2);case 2:return e.btnEmailRegister.disabled=!0,e.btnEmailRegister.textContent="Creating account...",n.n=3,(0,u.eJ)(h,t,o);case 3:n.n=5;break;case 4:n.p=4,a=n.v,console.error("Email registration failed:",a),r="Registration failed","auth/email-already-in-use"===a.code?r="An account with this email already exists":"auth/invalid-email"===a.code?r="Invalid email address":"auth/weak-password"===a.code&&(r="Password is too weak. Please choose a stronger password"),alert(r),e.btnEmailRegister.disabled=!1,e.btnEmailRegister.textContent="Register";case 5:return n.a(2)}},n,null,[[0,4]])}))),e.passwordInput.addEventListener("keypress",function(n){"Enter"===n.key&&e.btnEmailLogin.click()})}function T(e){return _.apply(this,arguments)}function _(){return(_=E(b().m(function e(n){var t,o,r,a,i;return b().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,fetch("check_admin.php?user_id=".concat(encodeURIComponent(n)));case 1:return t=e.v,e.n=2,t.json();case 2:e.v.is_admin&&(o=document.getElementById("userInfo"))&&!o.querySelector(".admin-link")&&((r=document.createElement("a")).href="admin.php?user_id=".concat(encodeURIComponent(n)),r.className="admin-link",r.style.cssText="background: #dc2626; color: white; padding: 6px 12px; border-radius: 6px; text-decoration: none; font-size: 12px; margin-right: 8px;",r.textContent="Admin",(a=o.querySelector("#ordersLink"))?o.insertBefore(r,a):o.appendChild(r)),e.n=4;break;case 3:e.p=3,i=e.v,console.log("Admin check failed:",i);case 4:return e.a(2)}},e,null,[[0,3]])}))).apply(this,arguments)}function S(){var e,n,t="function"==typeof Symbol?Symbol:{},o=t.iterator||"@@iterator",r=t.toStringTag||"@@toStringTag";function a(t,o,r,a){var s=o&&o.prototype instanceof c?o:c,l=Object.create(s.prototype);return j(l,"_invoke",function(t,o,r){var a,c,s,l=0,d=r||[],u=!1,p={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(n,t){return a=n,c=0,s=e,p.n=t,i}};function f(t,o){for(c=t,s=o,n=0;!u&&l&&!r&&n<d.length;n++){var r,a=d[n],f=p.p,m=a[2];t>3?(r=m===o)&&(s=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=e):a[0]<=f&&((r=t<2&&f<a[1])?(c=0,p.v=o,p.n=a[1]):f<m&&(r=t<3||a[0]>o||o>m)&&(a[4]=t,a[5]=o,p.n=m,c=0))}if(r||t>1)return i;throw u=!0,o}return function(r,d,m){if(l>1)throw TypeError("Generator is already running");for(u&&1===d&&f(d,m),c=d,s=m;(n=c<2?e:s)||!u;){a||(c?c<3?(c>1&&(p.n=-1),f(c,s)):p.n=s:p.v=s);try{if(l=2,a){if(c||(r="next"),n=a[r]){if(!(n=n.call(a,s)))throw TypeError("iterator result is not an object");if(!n.done)return n;s=n.value,c<2&&(c=0)}else 1===c&&(n=a.return)&&n.call(a),c<2&&(s=TypeError("The iterator does not provide a '"+r+"' method"),c=1);a=e}else if((n=(u=p.n<0)?s:t.call(o,p))!==i)break}catch(n){a=e,c=1,s=n}finally{l=1}}return{value:n,done:u}}}(t,r,a),!0),l}var i={};function c(){}function s(){}function l(){}n=Object.getPrototypeOf;var d=[][o]?n(n([][o]())):(j(n={},o,function(){return this}),n),u=l.prototype=c.prototype=Object.create(d);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,j(e,r,"GeneratorFunction")),e.prototype=Object.create(u),e}return s.prototype=l,j(u,"constructor",l),j(l,"constructor",s),s.displayName="GeneratorFunction",j(l,r,"GeneratorFunction"),j(u),j(u,r,"Generator"),j(u,o,function(){return this}),j(u,"toString",function(){return"[object Generator]"}),(S=function(){return{w:a,m:p}})()}function j(e,n,t,o){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}j=function(e,n,t,o){function a(n,t){j(e,n,function(e){return this._invoke(n,t,e)})}n?r?r(e,n,{value:t,enumerable:!o,configurable:!o,writable:!o}):e[n]=t:(a("next",0),a("throw",1),a("return",2))},j(e,n,t,o)}function B(e,n,t,o,r,a,i){try{var c=e[a](i),s=c.value}catch(e){return void t(e)}c.done?n(s):Promise.resolve(s).then(o,r)}function z(e){return function(){var n=this,t=arguments;return new Promise(function(o,r){var a=e.apply(n,t);function i(e){B(a,o,r,i,c,"next",e)}function c(e){B(a,o,r,i,c,"throw",e)}i(void 0)})}}function A(){var e,n,t="function"==typeof Symbol?Symbol:{},o=t.iterator||"@@iterator",r=t.toStringTag||"@@toStringTag";function a(t,o,r,a){var s=o&&o.prototype instanceof c?o:c,l=Object.create(s.prototype);return F(l,"_invoke",function(t,o,r){var a,c,s,l=0,d=r||[],u=!1,p={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(n,t){return a=n,c=0,s=e,p.n=t,i}};function f(t,o){for(c=t,s=o,n=0;!u&&l&&!r&&n<d.length;n++){var r,a=d[n],f=p.p,m=a[2];t>3?(r=m===o)&&(s=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=e):a[0]<=f&&((r=t<2&&f<a[1])?(c=0,p.v=o,p.n=a[1]):f<m&&(r=t<3||a[0]>o||o>m)&&(a[4]=t,a[5]=o,p.n=m,c=0))}if(r||t>1)return i;throw u=!0,o}return function(r,d,m){if(l>1)throw TypeError("Generator is already running");for(u&&1===d&&f(d,m),c=d,s=m;(n=c<2?e:s)||!u;){a||(c?c<3?(c>1&&(p.n=-1),f(c,s)):p.n=s:p.v=s);try{if(l=2,a){if(c||(r="next"),n=a[r]){if(!(n=n.call(a,s)))throw TypeError("iterator result is not an object");if(!n.done)return n;s=n.value,c<2&&(c=0)}else 1===c&&(n=a.return)&&n.call(a),c<2&&(s=TypeError("The iterator does not provide a '"+r+"' method"),c=1);a=e}else if((n=(u=p.n<0)?s:t.call(o,p))!==i)break}catch(n){a=e,c=1,s=n}finally{l=1}}return{value:n,done:u}}}(t,r,a),!0),l}var i={};function c(){}function s(){}function l(){}n=Object.getPrototypeOf;var d=[][o]?n(n([][o]())):(F(n={},o,function(){return this}),n),u=l.prototype=c.prototype=Object.create(d);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,F(e,r,"GeneratorFunction")),e.prototype=Object.create(u),e}return s.prototype=l,F(u,"constructor",l),F(l,"constructor",s),s.displayName="GeneratorFunction",F(l,r,"GeneratorFunction"),F(u),F(u,r,"Generator"),F(u,o,function(){return this}),F(u,"toString",function(){return"[object Generator]"}),(A=function(){return{w:a,m:p}})()}function F(e,n,t,o){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}F=function(e,n,t,o){function a(n,t){F(e,n,function(e){return this._invoke(n,t,e)})}n?r?r(e,n,{value:t,enumerable:!o,configurable:!o,writable:!o}):e[n]=t:(a("next",0),a("throw",1),a("return",2))},F(e,n,t,o)}function U(e,n,t,o,r,a,i){try{var c=e[a](i),s=c.value}catch(e){return void t(e)}c.done?n(s):Promise.resolve(s).then(o,r)}function W(e){return function(){var n=this,t=arguments;return new Promise(function(o,r){var a=e.apply(n,t);function i(e){U(a,o,r,i,c,"next",e)}function c(e){U(a,o,r,i,c,"throw",e)}i(void 0)})}}function H(e){return q.apply(this,arguments)}function q(){return(q=W(A().m(function e(n){var t,o,r;return A().w(function(e){for(;;)switch(e.p=e.n){case 0:return t=new URLSearchParams({size:"512x512",margin:"1",data:n}),e.p=1,e.n=2,fetch("https://api.qrserver.com/v1/create-qr-code/?".concat(t));case 2:if((o=e.v).ok){e.n=3;break}throw new Error("QR service error");case 3:return e.n=4,o.blob();case 4:return e.a(2,e.v);case 5:throw e.p=5,r=e.v,console.error("QR generation failed:",r),new Error("Failed to generate QR code");case 6:return e.a(2)}},e,null,[[1,5]])}))).apply(this,arguments)}function G(e,n){return D.apply(this,arguments)}function D(){return D=W(A().m(function e(n,t){var o,r,a,i,c,s=arguments;return A().w(function(e){for(;;)switch(e.p=e.n){case 0:return o=s.length>2&&void 0!==s[2]?s[2]:"waveforms",e.p=1,r=(0,f.KR)(y,"".concat(o,"/").concat(t)),e.n=2,(0,f.D)(r,n);case 2:return a=e.v,e.n=3,(0,f.qk)(a.ref);case 3:return i=e.v,e.a(2,i);case 4:if(e.p=4,c=e.v,console.error("Firebase Storage upload failed:",c),"storage/unauthorized"!==c.code){e.n=5;break}throw new Error("Permission denied. Please check Firebase Storage rules allow authenticated uploads.");case 5:if("storage/unauthenticated"!==c.code){e.n=6;break}throw new Error("Authentication required. Please sign in first.");case 6:if("storage/quota-exceeded"!==c.code){e.n=7;break}throw new Error("Storage quota exceeded. Please contact administrator.");case 7:if("storage/invalid-format"!==c.code){e.n=8;break}throw new Error("Invalid file format. Only PNG images are supported.");case 8:throw new Error("Firebase Storage error: ".concat(c.message));case 9:return e.a(2)}},e,null,[[1,4]])})),D.apply(this,arguments)}function N(){return N=W(A().m(function e(n,t,o){var r,a,i,c,s,l,d,u,p,f,m,g,v=arguments;return A().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r=v.length>3&&void 0!==v[3]?v[3]:null,e.p=1,a=Date.now(),i=t.replace(/\.[^.]+$/,""),c="".concat(o,"_").concat(a,"_").concat(i,"_waveform.png"),s="".concat(o,"_").concat(a,"_").concat(i,"_qr.png"),l=null,!n){e.n=3;break}return e.n=2,G(n,c,"waveforms");case 2:l=e.v;case 3:if(d=null,u=null,!r){e.n=5;break}return p="".concat(o,"_").concat(a,"_").concat(i,"_audio.").concat(r.name.split(".").pop()),e.n=4,G(r,p,"audio");case 4:d=e.v;case 5:return u="".concat(window.location.origin,"/Wavemy/play.php?id=TEMP_ID"),e.n=6,H(u);case 6:return f=e.v,e.n=7,G(f,s,"qr-codes");case 7:return m=e.v,e.a(2,{waveformUrl:l,qrUrl:m,audioUrl:d,playPageUrl:u,success:!0});case 8:return e.p=8,g=e.v,console.error("Upload process failed:",g),e.a(2,{error:g.message,success:!1})}},e,null,[[1,8]])})),N.apply(this,arguments)}function R(e){return K.apply(this,arguments)}function K(){return(K=W(A().m(function e(n){var t,o;return A().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,t=(0,f.KR)(y,n),e.n=1,(0,f.XR)(t);case 1:return e.a(2,!0);case 2:if(e.p=2,o=e.v,console.error("‚ùå Failed to delete from Firebase Storage:",o),"storage/object-not-found"!==o.code){e.n=3;break}return e.a(2,!0);case 3:return e.a(2,!1)}},e,null,[[0,2]])}))).apply(this,arguments)}function V(){return(V=W(A().m(function e(n,t){var o,r,a,i,c,s;return A().w(function(e){for(;;)switch(e.p=e.n){case 0:if(o=[],e.p=1,!n||!n.includes("firebasestorage.googleapis.com")){e.n=3;break}if(!(r=Q(n))){e.n=3;break}return e.n=2,R(r);case 2:a=e.v,o.push({type:"image",path:r,success:a});case 3:if(!t||!t.includes("firebasestorage.googleapis.com")){e.n=5;break}if(!(i=Q(t))){e.n=5;break}return e.n=4,R(i);case 4:c=e.v,o.push({type:"audio",path:i,success:c});case 5:return e.a(2,{success:!0,results:o});case 6:return e.p=6,s=e.v,console.error("Error deleting memory files:",s),e.a(2,{success:!1,error:s.message,results:o})}},e,null,[[1,6]])}))).apply(this,arguments)}function Q(e){try{var n=e.match(/\/o\/([^?]+)/);return n?decodeURIComponent(n[1]):null}catch(e){return console.error("Error extracting storage path:",e),null}}function X(e){var n,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3,r=(document.querySelectorAll(".toast"),(n=document.getElementById("toast-container"))||((n=document.createElement("div")).id="toast-container",n.style.cssText="\n      position: fixed;\n      top: 20px;\n      right: 20px;\n      z-index: 10000;\n      pointer-events: none;\n    ",n.addEventListener("click",function(e){e.target.closest(".toast")&&(e.target.closest(".toast").style.pointerEvents="auto")}),n.style.pointerEvents="none",n.querySelectorAll(".toast").forEach(function(e){e.style.pointerEvents="auto"}),document.body.appendChild(n)),n),a=document.createElement("div");a.className="toast toast-".concat(t);var i={success:{bg:"#10b981",icon:"‚úì"},error:{bg:"#ef4444",icon:"‚úï"},warning:{bg:"#f59e0b",icon:"‚ö†"},info:{bg:"#3b82f6",icon:"‚Ñπ"}},c=i[t]||i.info;return a.innerHTML='\n    <div class="toast-content">\n      <span class="toast-icon">'.concat(c.icon,'</span>\n      <span class="toast-message">').concat(e,'</span>\n      <button class="toast-close" onclick="this.parentElement.parentElement.remove()">√ó</button>\n    </div>\n  '),a.style.cssText="\n    background: ".concat(c.bg,";\n    color: white;\n    padding: 12px 16px;\n    border-radius: 8px;\n    margin-bottom: 8px;\n    box-shadow: 0 4px 12px rgba(0,0,0,0.15);\n    opacity: 0;\n    transform: translateX(100%);\n    transition: all 0.3s ease;\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    max-width: 400px;\n    word-wrap: break-word;\n  "),a.querySelector(".toast-content").style.cssText="\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    flex: 1;\n  ",a.querySelector(".toast-close").style.cssText="\n    background: none;\n    border: none;\n    color: white;\n    cursor: pointer;\n    font-size: 18px;\n    padding: 0;\n    margin-left: 12px;\n    opacity: 0.8;\n  ",a.querySelector(".toast-close").addEventListener("mouseenter",function(e){e.target.style.opacity="1"}),a.querySelector(".toast-close").addEventListener("mouseleave",function(e){e.target.style.opacity="0.8"}),r.appendChild(a),requestAnimationFrame(function(){a.style.opacity="1",a.style.transform="translateX(0)"}),o>0&&setTimeout(function(){a&&a.parentNode&&(a.style.opacity="0",a.style.transform="translateX(100%)",setTimeout(function(){a&&a.parentNode&&a.remove()},300))},o),a}function Y(){if(!document.getElementById("utils-styles")){var e=document.createElement("style");e.id="utils-styles",e.textContent="\n      @keyframes spin {\n        to { transform: rotate(360deg); }\n      }\n      \n      .loading {\n        position: relative;\n        opacity: 0.7;\n        pointer-events: none;\n      }\n    ",document.head.appendChild(e)}}window.deleteMemory=function(){var e=z(S().m(function e(n,t,o){var r,a,i,c,s,l,d;return S().w(function(e){for(;;)switch(e.p=e.n){case 0:if(window.showConfirmDialog){e.n=1;break}return alert("Utility functions not loaded"),e.a(2);case 1:return e.n=2,window.showConfirmDialog('Are you sure you want to delete "'.concat(t,'"? This action cannot be undone.'),"Delete Memory");case 2:if(e.v){e.n=3;break}return e.a(2);case 3:if(r=o.textContent,o.textContent="Deleting...",o.disabled=!0,e.p=4,a=window.getCurrentUser()){e.n=5;break}throw new Error("Not authenticated");case 5:return e.n=6,fetch("delete_memory.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"memory_id=".concat(n,"&user_id=").concat(encodeURIComponent(a.uid))});case 6:if((i=e.v).ok){e.n=7;break}throw new Error("Delete request failed");case 7:return e.n=8,i.json();case 8:if(!(c=e.v).success){e.n=13;break}if((s=o.closest(".waveform-item"))&&s.remove(),window.showToast&&window.showToast('"'.concat(t,'" has been deleted.'),"success"),!window.deleteMemoryFiles||!c.files){e.n=12;break}return e.p=9,e.n=10,window.deleteMemoryFiles(c.files);case 10:e.n=12;break;case 11:e.p=11,l=e.v,console.warn("Storage cleanup failed:",l);case 12:e.n=14;break;case 13:throw new Error(c.error||"Delete failed");case 14:e.n=16;break;case 15:e.p=15,d=e.v,console.error("Delete error:",d),window.handleError?window.handleError(d,"Delete Memory"):alert("Error deleting memory: "+d.message);case 16:return e.p=16,o.textContent=r,o.disabled=!1,e.f(16);case 17:return e.a(2)}},e,null,[[9,11],[4,15,16,17]])}));return function(n,t,o){return e.apply(this,arguments)}}(),window.loadUserWaveforms=M,window.showMemoryModal=function(e,n,t){var o=document.createElement("div");o.className="image-modal",o.onclick=function(e){e.target===o&&window.closeImageModal()},o.innerHTML='\n    <div class="image-modal-content">\n      <button class="image-modal-close" onclick="closeImageModal()" title="Close">&times;</button>\n      <div style="text-align: center; margin-bottom: 16px;">\n        <h3 style="color: white; margin: 0 0 8px 0;">'.concat(n,'</h3>\n        <a href="').concat(t,'" target="_blank" style="color: #60a5fa; text-decoration: none; font-size: 14px;">üéµ Play Audio</a>\n      </div>\n      <img src="').concat(e,'" alt="Complete Memory Frame" style="max-width: 100%; max-height: 100%;">\n    </div>\n  '),document.body.appendChild(o),window.currentImageModal=o,document.addEventListener("keydown",window.handleImageModalKeydown)},window.closeImageModal=function(){window.currentImageModal&&(window.currentImageModal.remove(),window.currentImageModal=null,document.removeEventListener("keydown",window.handleImageModalKeydown))},window.handleImageModalKeydown=function(e){"Escape"===e.key&&window.closeImageModal()},window.showImageModal=function(){var e=document.getElementById("imageLink"),n=e?e.href:null;if(n&&"#"!==n){var t=document.createElement("div");t.className="image-modal",t.onclick=function(e){e.target===t&&window.closeImageModal()},t.innerHTML='\n    <div class="image-modal-content">\n      <button class="image-modal-close" onclick="closeImageModal()" title="Close">&times;</button>\n      <img src="'.concat(n,'" alt="Complete Memory Frame" style="max-width: 100%; max-height: 100%;">\n    </div>\n  '),document.body.appendChild(t),window.currentImageModal=t,document.addEventListener("keydown",window.handleImageModalKeydown)}else window.showToast?window.showToast("No image available to display","warning"):alert("No image available to display")},window.loadMoreMemories=function(){var e=window.currentWaveformsOffset||0;console.log("üîç Load more clicked, current offset:",e),window.getCurrentUser&&window.getCurrentUser()?window.loadMoreWaveforms(e):console.log("üîç No user for load more")},window.loadMoreWaveforms=function(){var e=z(S().m(function e(n){var t,o,r,a,i,c,s,l,d,u,p;return S().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,console.log("üîç Loading more waveforms from offset:",n),t=window.getCurrentUser(),e.n=1,fetch("get_waveforms.php?user_id=".concat(encodeURIComponent(t.uid),"&offset=").concat(n,"&limit=5"));case 1:if((o=e.v).ok){e.n=2;break}throw new Error("Failed to load more waveforms");case 2:return e.n=3,o.json();case 3:if(r=e.v,console.log("üîç Load more response:",r),a=Array.isArray(r)?r:r.waveforms||[],i=r.has_more||!1,c=r.total||0,console.log("üîç Additional waveforms:",a.length,"hasMore:",i),!(a.length>0)){e.n=5;break}if(s=document.getElementById("waveformsContainer")){e.n=4;break}return e.a(2);case 4:l=a.map(function(e){var n=e.title||e.original_name||"Untitled",t=new Date(e.created_at).toLocaleDateString(),o=new Date(e.created_at).toLocaleTimeString();return'\n          <div class="waveform-item" style="border: 1px solid #e6e9f2; border-radius: 8px; padding: 12px; margin-bottom: 8px; background: #fafbfc;">\n            <div style="display: flex; justify-content: space-between; align-items: center;">\n              <div>\n                <strong style="color: #0b0d12;">'.concat(n,'</strong>\n                <div class="muted" style="font-size: 12px; margin-top: 2px;">\n                  ').concat(e.original_name," ‚Ä¢ ").concat(t," ").concat(o,'\n                </div>\n              </div>\n              <div style="display: flex; gap: 8px; flex-wrap: wrap;">\n                <button onclick="showMemoryModal(\'').concat(e.image_url,"', '").concat(n.replace(/'/g,"\\'"),"', '").concat(e.qr_url,'\')" class="secondary" style="font-size: 12px; padding: 4px 8px; border: none; cursor: pointer;">View</button>\n                <a href="').concat(e.qr_url,'" target="_blank" class="secondary" style="font-size: 12px; padding: 4px 8px;">QR</a>\n                <button onclick="showOrderOptions(').concat(e.id,", '").concat(e.image_url,"', '").concat(n.replace(/'/g,"\\'"),'\', this)" style="background: #2a4df5; border: none; color: white; padding: 4px 8px; border-radius: 4px; cursor: pointer; font-size: 12px;">Order Print</button>\n                <button onclick="deleteMemory(').concat(e.id,", '").concat(n.replace(/'/g,"\\'"),'\', this)" class="btn-delete" style="background: #dc3545; border: none; color: white; padding: 4px 8px; border-radius: 4px; cursor: pointer; font-size: 12px;">Delete</button>\n              </div>\n            </div>\n          </div>\n        ')}).join(""),(d=s.querySelector("#loadMoreBtn"))&&d.remove(),s.insertAdjacentHTML("beforeend",l),i&&((u=document.createElement("div")).id="loadMoreBtn",u.style.cssText="text-align: center; margin-top: 16px;",u.innerHTML='\n          <button onclick="loadMoreMemories()" style="background: #6b7280; border: none; color: white; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-weight: 500;">\n            Load More ('.concat(c-n-a.length," remaining)\n          </button>\n        "),s.appendChild(u)),window.currentWaveformsOffset=n+a.length,console.log("üîç Updated offset to:",window.currentWaveformsOffset);case 5:e.n=7;break;case 6:e.p=6,p=e.v,console.error("üîç Error loading more waveforms:",p),window.handleError?window.handleError(p,"Load More Memories"):alert("Error loading more memories: "+p.message);case 7:return e.a(2)}},e,null,[[0,6]])}));return function(n){return e.apply(this,arguments)}}(),window.orderProduct=function(){var e=z(S().m(function e(n,t,o){var r,a,i,c,s;return S().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,r=window.getCurrentUser?window.getCurrentUser():null){e.n=1;break}return alert("Please sign in to place an order"),e.a(2);case 1:return console.log("Creating order for:",{productId:n,memoryId:t,imageUrl:o}),e.n=2,fetch("create_checkout.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({product_id:n,memory_id:t,image_url:o,user_id:r.uid,user_email:r.email,user_name:r.displayName||r.email})});case 2:if(a=e.v,console.log("Checkout response status:",a.status),a.ok){e.n=4;break}return e.n=3,a.text();case 3:throw i=e.v,console.error("Checkout response error:",i),new Error("HTTP ".concat(a.status,": ").concat(i));case 4:return e.n=5,a.json();case 5:c=e.v,console.log("Checkout result:",c),c.success&&c.checkout_url?window.location.href=c.checkout_url:alert("Error creating order: "+(c.error||"Unknown error")),e.n=7;break;case 6:e.p=6,s=e.v,console.error("Order error:",s),alert("Error placing order: "+s.message);case 7:return e.a(2)}},e,null,[[0,6]])}));return function(n,t,o){return e.apply(this,arguments)}}(),window.showOrderOptions=function(){var e=z(S().m(function e(n,t,o,r){var a,i,c,s,l,d;return S().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,a=r.textContent,r.textContent="Loading...",r.disabled=!0,(i=document.createElement("div")).style.cssText="\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      background: rgba(0,0,0,0.6);\n      backdrop-filter: blur(4px);\n      z-index: 1000;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      padding: 20px;\n    ",e.n=1,fetch("get_products.php");case 1:return c=e.v,e.n=2,c.json();case 2:s=e.v,l='\n      <div style="background: white; border-radius: 20px; padding: 32px; max-width: 600px; width: 100%; max-height: 80vh; overflow-y: auto;">\n        <div style="text-align: center; margin-bottom: 24px;">\n          <h2 style="margin: 0 0 8px 0; color: #0b0d12;">Order Print for "'.concat(o,'"</h2>\n          <p style="margin: 0; color: #6b7280;">Choose your preferred print size and material</p>\n        </div>\n        \n        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 16px; margin-bottom: 24px;">\n          ').concat(s.map(function(e){return'\n            <div class="product-card" style="border: 2px solid #e6e9f2; border-radius: 12px; padding: 16px; background: #fafbfc; text-align: center; transition: all 0.2s ease; cursor: pointer;" \n                 onclick="selectProduct(\''.concat(e.id,"', ").concat(n,", '").concat(t,'\', this)">\n              <div style="font-size: 32px; margin-bottom: 12px;">üñºÔ∏è</div>\n              <div style="font-weight: 600; color: #0b0d12; margin-bottom: 4px; font-size: 14px;">').concat(e.name,'</div>\n              <div style="font-size: 12px; color: #6b7280; margin-bottom: 8px;">').concat(e.size,'</div>\n              <div style="font-size: 12px; color: #6b7280; margin-bottom: 12px;">').concat(e.material,'</div>\n              <div style="font-size: 18px; font-weight: 600; color: #2a4df5;">').concat(e.price_formatted,'</div>\n              <div style="font-size: 11px; color: #6b7280; margin-top: 8px;">').concat(e.description,"</div>\n            </div>\n          ")}).join(""),'\n        </div>\n        \n        <div style="text-align: center;">\n          <button onclick="closeOrderModal()" style="background: #6b7280; border: none; color: white; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 500;">\n            Cancel\n          </button>\n        </div>\n      </div>\n    '),i.innerHTML=l,document.body.appendChild(i),window.currentOrderModal=i,r.textContent=a,r.disabled=!1,e.n=4;break;case 3:e.p=3,d=e.v,console.error("Error showing order options:",d),alert("Error loading order options: "+d.message),r.textContent=originalText,r.disabled=!1;case 4:return e.a(2)}},e,null,[[0,3]])}));return function(n,t,o,r){return e.apply(this,arguments)}}(),window.selectProduct=function(){var e=z(S().m(function e(n,t,o,r){return S().w(function(e){for(;;)switch(e.n){case 0:return r.style.borderColor="#2a4df5",r.style.background="#f0f4ff",window.closeOrderModal(),e.n=1,window.orderProduct(n,t,o);case 1:return e.a(2)}},e)}));return function(n,t,o,r){return e.apply(this,arguments)}}(),window.closeOrderModal=function(){window.currentOrderModal&&(window.currentOrderModal.remove(),window.currentOrderModal=null)},console.log("üåü Global functions loaded and available"),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",Y):Y(),document.addEventListener("DOMContentLoaded",function(){console.log("üöÄ DOM loaded, initializing app...");try{P(),console.log("‚úÖ Auth initialization started")}catch(e){console.error("‚ùå Auth initialization failed:",e),setTimeout(function(){var n=document.createElement("div");n.style.cssText="\n        position: fixed; top: 0; left: 0; right: 0; \n        background: #dc2626; color: white; padding: 16px; \n        text-align: center; z-index: 10000;\n      ",n.textContent="‚ö†Ô∏è App initialization failed: "+e.message,document.body.appendChild(n)},1e3)}}),window.addEventListener("load",function(){console.log("üöÄ Window loaded, checking if auth is initialized...");var e=document.getElementById("btnLogin");if(e&&!e.dataset.initialized){console.log("üîÑ Login button found but not initialized, retrying...");try{P()}catch(e){console.error("‚ùå Retry auth initialization failed:",e)}}}),window.getCurrentUser=function(){return L},window.uploadWaveformFiles=function(e,n,t){return N.apply(this,arguments)},window.deleteMemoryFiles=function(e,n){return V.apply(this,arguments)},window.showToast=X,window.showLoading=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Loading...";if(e&&(e.classList.add("loading"),e.dataset.originalText=e.textContent,e.textContent=n,e.disabled=!0,!e.querySelector(".loading-spinner"))){var t=document.createElement("span");t.className="loading-spinner",t.style.cssText="\n      display: inline-block;\n      width: 14px;\n      height: 14px;\n      border: 2px solid rgba(255,255,255,0.3);\n      border-top: 2px solid white;\n      border-radius: 50%;\n      animation: spin 1s linear infinite;\n      margin-right: 8px;\n    ",e.prepend(t)}},window.hideLoading=function(e){if(e){e.classList.remove("loading"),e.disabled=!1;var n=e.querySelector(".loading-spinner");n&&n.remove(),e.dataset.originalText&&(e.textContent=e.dataset.originalText,delete e.dataset.originalText)}},window.showConfirmDialog=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Confirm Action";return new Promise(function(t){var o=document.createElement("div");o.className="confirm-overlay",o.style.cssText="\n      position: fixed;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      background: rgba(0,0,0,0.6);\n      backdrop-filter: blur(4px);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      z-index: 10001;\n      opacity: 0;\n      transition: opacity 0.3s ease;\n    ";var r=document.createElement("div");r.className="confirm-dialog",r.style.cssText="\n      background: white;\n      padding: 24px;\n      border-radius: 12px;\n      max-width: 400px;\n      width: 90%;\n      text-align: center;\n      box-shadow: 0 20px 40px rgba(0,0,0,0.2);\n      transform: scale(0.9);\n      transition: transform 0.3s ease;\n    ",r.innerHTML='\n      <h3 style="margin: 0 0 16px 0; color: #0b0d12; font-size: 18px;">'.concat(n,'</h3>\n      <p style="margin: 0 0 24px 0; color: #6b7280; line-height: 1.5;">').concat(e,'</p>\n      <div style="display: flex; gap: 12px; justify-content: center;">\n        <button id="confirm-cancel" style="background: #6b7280; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer;">\n          Cancel\n        </button>\n        <button id="confirm-ok" style="background: #ef4444; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer;">\n          Confirm\n        </button>\n      </div>\n    '),o.appendChild(r),document.body.appendChild(o),requestAnimationFrame(function(){o.style.opacity="1",r.style.transform="scale(1)"});var a=function(){o.style.opacity="0",r.style.transform="scale(0.9)",setTimeout(function(){return o.remove()},300)};r.querySelector("#confirm-cancel").addEventListener("click",function(){a(),t(!1)}),r.querySelector("#confirm-ok").addEventListener("click",function(){a(),t(!0)});var i=function(e){"Escape"===e.key&&(a(),t(!1),document.removeEventListener("keydown",i))};document.addEventListener("keydown",i),o.addEventListener("click",function(e){e.target===o&&(a(),t(!1))})})},window.handleError=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Unknown",t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(console.error("Error in ".concat(n,":"),e),"undefined"!=typeof gtag&&gtag("event","exception",{description:"".concat(n,": ").concat(e.message),fatal:!1}),t){var o=function(e,n){var t,o=(null===(t=e.message)||void 0===t?void 0:t.toLowerCase())||"";return o.includes("network")||o.includes("fetch")?"Unable to connect to the server. Please check your internet connection and try again.":o.includes("auth")||o.includes("permission")?"Authentication failed. Please sign in again.":n.includes("upload")||o.includes("file")?"File upload failed. Please check the file format and try again.":n.includes("payment")||o.includes("stripe")?"Payment processing failed. Please check your payment details and try again.":"Something went wrong. Please try again later."}(e,n);X(o,"error")}},window.formatFileSize=function(e){if(0===e)return"0 Bytes";var n=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,n)).toFixed(2))+" "+["Bytes","KB","MB","GB"][n]},window.validateFileType=function(e,n){return n.includes(e.type)},window.validateFileSize=function(e,n){return e.size<=n}}},t={};function o(e){var r=t[e];if(void 0!==r)return r.exports;var a=t[e]={exports:{}};return n[e](a,a.exports,o),a.exports}o.m=n,e=[],o.O=(n,t,r,a)=>{if(!t){var i=1/0;for(d=0;d<e.length;d++){for(var[t,r,a]=e[d],c=!0,s=0;s<t.length;s++)(!1&a||i>=a)&&Object.keys(o.O).every(e=>o.O[e](t[s]))?t.splice(s--,1):(c=!1,a<i&&(i=a));if(c){e.splice(d--,1);var l=r();void 0!==l&&(n=l)}}return n}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[t,r,a]},o.d=(e,n)=>{for(var t in n)o.o(n,t)&&!o.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),(()=>{var e={792:0};o.O.j=n=>0===e[n];var n=(n,t)=>{var r,a,[i,c,s]=t,l=0;if(i.some(n=>0!==e[n])){for(r in c)o.o(c,r)&&(o.m[r]=c[r]);if(s)var d=s(o)}for(n&&n(t);l<i.length;l++)a=i[l],o.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return o.O(d)},t=self.webpackChunkwavemy=self.webpackChunkwavemy||[];t.forEach(n.bind(null,0)),t.push=n.bind(null,t.push.bind(t))})();var r=o.O(void 0,[96],()=>o(923));r=o.O(r)})();
//# sourceMappingURL=bundle.0831caa59b61a8784be1.js.map